(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08d06552"],{4523:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{bordered:!1}},[t("a-page-header",{attrs:{title:"add"==e.type?"创建新版本":"编辑版本"},on:{back:function(t){return e.$multiTab.closeCurrentPage()}}},[t("div",{staticStyle:{width:"500px",margin:"0 auto"}},[t("a-steps",{attrs:{current:e.current}},e._l(e.steps,(function(e){return t("a-step",{key:e.title,attrs:{title:e.title}})})),1)],1),t("div",{staticStyle:{height:"20px"}}),t("basic-message",{directives:[{name:"show",rawName:"v-show",value:0===e.current,expression:"current === 0"}],ref:"basicMsg",attrs:{type:e.type,id:e.id},on:{next:e.handleNextStep}}),t("putaway-skin",{directives:[{name:"show",rawName:"v-show",value:1===e.current,expression:"current === 1"}],ref:"skin",attrs:{id:e.id}}),t("div",{staticStyle:{width:"500px","text-align":"center",margin:"20px auto"}},[0===e.current?t("a-button",{attrs:{type:"primary"},on:{click:e.nextStep}},[e._v(" 保存 ")]):e._e(),0===e.current?t("a-divider",{attrs:{type:"vertical"}}):e._e(),1===e.current?t("a-button",{attrs:{type:"primary"},on:{click:function(t){e.current=0}}},[e._v(" 上一步 ")]):e._e(),1===e.current?t("a-divider",{attrs:{type:"vertical"}}):e._e(),t("a-button",{on:{click:e.handleCancel}},[e._v(" 取消 ")])],1)],1)],1)},n=[],i=a("c473"),s=a("7071"),o={name:"TemplateManageDetails",components:{"basic-message":i["default"],"putaway-skin":s["default"]},data:function(){return{current:0,type:"",id:"",steps:[{title:"基础信息"},{title:"上架皮肤"}],basicData:{}}},created:function(){this.type=this.$route.query.type||"",this.id=this.$route.query.id||""},methods:{nextStep:function(){this.$refs["basicMsg"].formValid()},handleNextStep:function(e){this.current=1,this.id=e},handleCancel:function(){this.$multiTab.closeCurrentPage()}}},c=o,l=a("2877"),u=Object(l["a"])(c,r,n,!1,null,"4bb704ea",null);t["default"]=u.exports},"65bd":function(e,t,a){},7071:function(e,t,a){"use strict";a.r(t);a("b0c0");var r=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"table-operator"},[t("a-row",{attrs:{type:"flex",justify:"space-between"}},[t("a-col",[t("a-alert",{attrs:{message:"请配置支持的上架临时皮肤",banner:""}})],1),t("a-col",[t("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleNew}},[e._v(" "+e._s(e.$t("public.add"))+" ")])],1)],1)],1),t("a-table",{attrs:{size:"small",rowKey:"id","data-source":e.dataSource,columns:e.columns,loading:e.loading,pagination:!1},scopedSlots:e._u([{key:"code",fn:function(a,r){return t("div",{},[e._v(" "+e._s(e.$DictName("skin_code",r.code))+" ")])}},{key:"previewImages",fn:function(a,r){return e._l(r.previewImages,(function(e,a){return t("img",{key:a,staticClass:"preview-image",attrs:{src:e}})}))}},{key:"action",fn:function(a,r){return[t("a-button",{attrs:{type:"link",size:"small",icon:"setting"},on:{click:function(t){return e.handleEdit(r)}}},[e._v(" 修改 ")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-button",{attrs:{type:"link",size:"small",icon:"delete"},on:{click:function(t){return e.handleDelete(r.id)}}},[e._v(" 删除 ")])]}}])}),t("a-modal",{attrs:{title:e.form.id?"编辑上架皮肤主题":"添加上架皮肤主题",width:640,visible:e.visible,"confirm-loading":e.confirmLoading},on:{cancel:e.handleCancel},scopedSlots:e._u([{key:"footer",fn:function(){return[t("a-button",{attrs:{type:"primary"},on:{click:e.handleFinish}},[e._v(" 完成 ")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-button",{key:"back",on:{click:e.handleCancel}},[e._v(" 关闭 ")])]},proxy:!0}])},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form-model",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules}},[t("a-form-model-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"名称(中文)",prop:"name"}},[t("a-input",{attrs:{placeholder:"请输入名称(中文)"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("a-form-model-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"名称(英文)",prop:"nameEn"}},[t("a-input",{attrs:{placeholder:"请输入名称(英文)"},model:{value:e.form.nameEn,callback:function(t){e.$set(e.form,"nameEn",t)},expression:"form.nameEn"}})],1),t("a-form-model-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"功能KEY",prop:"code"}},[t("a-select",{staticStyle:{width:"50%"},attrs:{placeholder:"请选择功能KEY值",options:e.$DictList("skin_code")},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),t("a-form-model-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"预览图",prop:"previewImages"}},[t("section",{staticClass:"upload-wrap"},e._l(e.form.previewImages,(function(a,r){return t("div",{key:r,staticClass:"upload-item"},[t("upload-img",{attrs:{imgDir:"module",imgRequest:!0,propsImgSrc:a,imgHint:""},on:{ok:function(t){return e.handleUpload(t,r)}}}),a?t("a-icon",{staticClass:"delete-icon",attrs:{type:"minus-circle"},on:{click:function(t){return e.deleteIcon(r)}}}):e._e()],1)})),0),e._v(" 至少上传3张，建议4-5张 ")]),t("a-form-model-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"备注说明",prop:"remark"}},[t("input-textarea",{attrs:{placeholder:"请输入备注说明"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1)],1)],1)},n=[],i=a("2909"),s=a("c7eb"),o=a("5530"),c=a("1da1"),l=(a("d81d"),a("b64b"),a("99af"),a("4de4"),a("d3b7"),a("a434"),a("0f49")),u=a("61f7"),p={props:{id:{type:String,default:""}},data:function(){return{loading:!1,dataSource:[],columns:[{dataIndex:"name",title:"皮肤名称"},{dataIndex:"code",title:"功能KEY",scopedSlots:{customRender:"code"}},{dataIndex:"previewImages",title:"预览图",scopedSlots:{customRender:"previewImages"}},{dataIndex:"remark",title:"备注说明",width:"20%"},{title:"操作",key:"action",align:"center",width:"180px",scopedSlots:{customRender:"action"}}],visible:!1,confirmLoading:!1,form:{previewImages:[""]},rules:{name:Object(u["c"])("请输入名称(中文)"),nameEn:Object(u["c"])("请输入名称(英文)"),code:Object(u["d"])("请选择功能KEY","string"),previewImages:[{required:!0,validator:function(e,t,a){t.length>3?a():a(new Error("请上传3-5张预览图，至少3张"))},trigger:""}]},labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}}},mounted:function(){this.id&&this.getSkinList()},methods:{getSkinList:function(){var e=this;return Object(c["a"])(Object(s["a"])().mark((function t(){var a,r;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["P"])({appTemplateId:e.id});case 2:if(r=t.sent,0===r.code){t.next=5;break}return t.abrupt("return");case 5:e.dataSource=(null===(a=r.data)||void 0===a||null===(a=a.list)||void 0===a?void 0:a.map((function(e){return Object(o["a"])(Object(o["a"])({},e),{},{previewImages:e.previewImages?JSON.parse(e.previewImages):[]})})))||[];case 6:case"end":return t.stop()}}),t)})))()},handleNew:function(){this.form={previewImages:[""]},this.visible=!0},handleEdit:function(e){this.form=Object(o["a"])(Object(o["a"])({},e),{},{previewImages:e.previewImages.length<5?[].concat(Object(i["a"])(e.previewImages),[""]):Object(i["a"])(e.previewImages)}),this.visible=!0},handleFinish:function(){var e=this;this.$refs["ruleForm"].validate(function(){var t=Object(c["a"])(Object(s["a"])().mark((function t(a){var r,n;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:if(r=Object(o["a"])(Object(o["a"])({},e.form),{},{previewImages:JSON.stringify(e.form.previewImages.filter((function(e){return""!==e}))),appTemplateId:e.id}),!e.form.id){t.next=9;break}return t.next=6,Object(l["x"])(r);case 6:t.t0=t.sent,t.next=12;break;case 9:return t.next=11,Object(l["i"])(r);case 11:t.t0=t.sent;case 12:if(n=t.t0,0===n.code){t.next=15;break}return t.abrupt("return");case 15:e.visible=!1,e.$refs["ruleForm"].resetFields(),e.getSkinList();case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleUpload:function(e,t){this.form.previewImages[t]=e.fullPath,t==this.form.previewImages.length-1&&this.form.previewImages.length<5&&this.form.previewImages.push(""),this.form.previewImages.length>3&&this.$refs["ruleForm"].clearValidate(["previewImages"])},deleteIcon:function(e){this.form.previewImages.splice(e,1)},handleDelete:function(e){var t=this;this.$confirm({title:"确定是否删除",content:"删除后，将不可恢复",onOk:function(){var a=Object(c["a"])(Object(s["a"])().mark((function a(){var r;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(l["r"])(e);case 2:if(r=a.sent,0===r.code){a.next=5;break}return a.abrupt("return");case 5:t.getSkinList();case 6:case"end":return a.stop()}}),a)})));function r(){return a.apply(this,arguments)}return r}()})},handleCancel:function(){this.visible=!1,this.$refs["ruleForm"].resetFields()}}},d=p,m=(a("f854"),a("2877")),f=Object(m["a"])(d,r,n,!1,null,"1ba42f1b",null);t["default"]=f.exports},f854:function(e,t,a){"use strict";a("65bd")}}]);