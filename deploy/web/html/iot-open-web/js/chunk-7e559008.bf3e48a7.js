(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7e559008"],{"39a2":function(e,a,t){},"8b9d":function(e,a,t){"use strict";t("39a2")},"909e":function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e._self._c;return a("a-modal",{attrs:{title:e.getTitle,width:680,visible:e.visible,"confirm-loading":e.confirmLoading,okText:e.getButtonText},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("p",{staticClass:"warning-text"},[e._v(e._s(e.$t("firmware.OTA.warning.text")))]),a("a-form-model",{ref:"ruleForm",staticClass:"regular-form",attrs:{model:e.data,rules:e.rules,"label-col":{span:5},"wrapper-col":{span:15}}},[a("a-form-model-item",{attrs:{label:e.$t("firmware.OTA.label.productName"),prop:"productName"}},[e._v(" "+e._s(e.data.productName)+" ")]),a("a-form-model-item",{attrs:{label:e.$t("firmware.OTA.label.firmwareName"),prop:"firmwareName"}},[e._v(" "+e._s(e.data.firmwareName)+" ")]),a("a-form-model-item",{attrs:{label:e.$t("firmware.OTA.label.version"),prop:"version"}},[e._v(" "+e._s(e.data.version)+" ")]),a("a-form-model-item",{attrs:{label:e.$t("firmware.OTA.label.releaseMode"),prop:"releaseMode"}},[a("a-select",{attrs:{placeholder:e.$t("firmware.OTA.placeholder.releaseMode"),options:e.$DictList("release_mode")},model:{value:e.data.releaseMode,callback:function(a){e.$set(e.data,"releaseMode",a)},expression:"data.releaseMode"}})],1),2==e.data.releaseMode?a("a-form-model-item",{attrs:{label:e.$t("firmware.OTA.label.graySetting"),prop:"graySetting"}},[a("a-select",{attrs:{placeholder:e.$t("firmware.OTA.placeholder.graySetting"),options:e.$DictList("gray_type")},on:{change:function(a){return e.handleClearValidate("grayScale")}},model:{value:e.data.graySetting,callback:function(a){e.$set(e.data,"graySetting",a)},expression:"data.graySetting"}})],1):e._e(),2==e.data.releaseMode&&3!=e.data.graySetting?a("a-form-model-item",{attrs:{label:1==e.data.graySetting?e.$t("firmware.OTA.label.grayScale.percent"):e.$t("firmware.OTA.label.grayScale.number"),prop:"grayScale"}},[a("a-input-number",{attrs:{precision:0,placeholder:1==e.data.graySetting?e.$t("firmware.OTA.label.grayScale.percent"):e.$t("firmware.OTA.label.grayScale.number"),min:1},model:{value:e.data.grayScale,callback:function(a){e.$set(e.data,"grayScale",a)},expression:"data.grayScale"}}),1==e.data.graySetting?a("span",[e._v(" %")]):e._e()],1):e._e(),3==e.data.graySetting?a("a-form-model-item",{attrs:{label:e.$t("firmware.OTA.label.deviceIds"),prop:"deviceIds"}},[a("section",{staticClass:"numerical-list-map"},[e._l(e.valueMap,(function(t,r){return a("div",{key:r,staticClass:"flex y-axis-center value-wrap"},[a("a-input",{staticStyle:{width:"230px","margin-bottom":"5px"},attrs:{maxLength:50,placeholder:e.$t("firmware.OTA.label.deviceIds")},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),0!==r?a("a-button",{attrs:{type:"link"},on:{click:function(a){return e.handleDeleteMap(r)}}},[e._v(e._s(e.$t("public.delete")))]):e._e()],1)})),a("a-button",{staticClass:"add-numerical-button",on:{click:e.addMap}},[a("plus-blue-icon")],1)],2)]):e._e()],1)],1)],1)},l=[],i=t("c7eb"),n=t("1da1"),o=(t("d81d"),t("a434"),t("04b3")),s=t("8be3"),d={name:"ReleaseOta",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:function(){}}},components:{PlusBlueIcon:o["F"]},data:function(){return{confirmLoading:!1,rules:{releaseMode:[{required:!0,message:this.$t("firmware.OTA.rules.releaseMode"),trigger:"change"}],graySetting:[{required:!0,message:this.$t("firmware.OTA.rules.graySetting"),trigger:"change"}],grayScale:[{required:!0,validator:this.grayScaleValidator,trigger:"blur"}],deviceIds:[{required:!0,validator:this.deviceIdsValidator,trigger:"blur"}]},valueMap:[{value:""}]}},computed:{getTitle:function(){return this.$t("firmware.OTA.title.publish")},getButtonText:function(){return this.$t("public.ok")}},mounted:function(){},methods:{grayScaleValidator:function(e,a,t){this.data.grayScale?t():1==this.data.graySetting?t(this.$t("firmware.OTA.rules.grayScale.percent")):t(this.$t("firmware.OTA.rules.grayScale.number"))},deviceIdsValidator:function(e,a,t){this.valueMap[0].value?t():t(this.$t("firmware.OTA.rules.grayScale.deviceId"))},handleOk:function(){var e=this;this.$refs.ruleForm.validate(function(){var a=Object(n["a"])(Object(i["a"])().mark((function a(t){var r,l;return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t){a.next=2;break}return a.abrupt("return");case 2:return e.confirmLoading=!0,r={productId:e.data.productId,firmwareId:e.data.firmwareId,firmwareVersionId:e.data.versionId,releaseMode:e.data.releaseMode,graySetting:e.data.graySetting,grayScale:e.data.grayScale,otaPkgId:e.data.id,publishId:e.data.publishId,deviceIds:e.valueMap.map((function(e){return e.value}))},a.next=6,Object(s["l"])(r);case 6:if(l=a.sent,e.confirmLoading=!1,0===l.code){a.next=10;break}return a.abrupt("return");case 10:e.$emit("handleOk");case 11:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())},handleCancel:function(){this.$emit("handleCancel")},handleClearValidate:function(e){var a;null===(a=this.$refs)||void 0===a||null===(a=a.ruleForm)||void 0===a||a.clearValidate([e])},addMap:function(){this.valueMap.push({value:""})},handleDeleteMap:function(e){this.valueMap.splice(e,1)}}},c=d,u=(t("8b9d"),t("2877")),m=Object(u["a"])(c,r,l,!1,null,"7728f757",null);a["default"]=m.exports}}]);