(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cd1fa824"],{b0aa:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t._self._c;return e("section",{staticClass:"page-wrap no-padding"},[e("a-page-header",{attrs:{title:t.$t("authorization.title")},on:{back:t.back}},[e("icon-font",{style:{fontSize:"24px"},attrs:{slot:"backIcon",type:"icon-back_arrow"},slot:"backIcon"}),e("section",{staticClass:"content"},[e("p",[t._v(t._s(t.$t("authorization.for.account"))+"ï¼š"+t._s(t.userName)+" "+t._s(t.$t("authorization.allocation")))]),e("h3",[t._v(t._s(t.$t("authorization.choose.role.type")))]),e("p",{staticClass:"tips"},[t._v(t._s(t.$t("authorization.tips")))]),e("h4",[t._v(t._s(t.$t("authorization.default.role.type")))]),e("a-radio-group",{on:{change:t.changeRole},model:{value:t.selectedRole,callback:function(e){t.selectedRole=e},expression:"selectedRole"}},t._l(t.roleList,(function(r){return e("a-radio-button",{key:r.roleId,attrs:{value:r.roleId}},[t._v(" "+t._s(r.roleName)+" ")])})),1),e("h4",[t._v(t._s(t.$t("authorization.customRole")))]),e("a-radio-group",{on:{change:t.changeRole},model:{value:t.selectedRole,callback:function(e){t.selectedRole=e},expression:"selectedRole"}},[t._l(t.customRoleList,(function(r){return e("a-radio-button",{key:r.roleId,attrs:{value:r.roleId}},[t._v(" "+t._s(r.roleName)+" "),e("a-icon",{attrs:{type:"close"},on:{click:function(e){return t.deleteRole(r.roleId)}}})],1)})),e("a-button",{staticClass:"add-role",attrs:{icon:"plus"},on:{click:t.addCustomRole}},[t._v(t._s(t.$t("authorization.customRole")))])],2),t.showValidText?e("p",{staticClass:"valid-text"},[t._v(t._s(t.$t("authorization.choose.role.type")))]):t._e(),e("section",{staticClass:"menu-tree"},[e("section",{staticClass:"flex y-axis-center title"},[e("div",[t._v(" "+t._s(t.$t("authorization.menu"))+" ")]),t.showEidt?e("a-button",{attrs:{type:"link"},on:{click:function(e){return t.editAuthorization()}}},[t._v(t._s(t.$t("authorization.edit")))]):t._e()],1),e("section",[e("a-row",t._l(t.treeData,(function(r,n){return e("a-col",{key:n,attrs:{md:6,sm:24}},[e("a-tree",{attrs:{checkable:"",disabled:"",checkStrictly:"",defaultExpandAll:"","auto-expand-parent":"","tree-data":[r],checkedKeys:t.treeCheckedKeys[n],replaceFields:{key:"id"}}},[e("i",{attrs:{slot:"switcherIcon"},slot:"switcherIcon"},[e("arrow-down-icon")],1)])],1)})),1)],1)]),e("section",{staticClass:"action-wrap"},[e("a-space",{attrs:{size:20}},[e("a-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v(t._s(t.$t("public.save")))]),e("a-button",{on:{click:t.handleCancel}},[t._v(t._s(t.$t("public.cancel")))])],1)],1)],1)],1)],1)},a=[],o=r("c7eb"),c=r("1da1"),i=r("2909"),s=r("5530"),u=(r("4de4"),r("d3b7"),r("99af"),r("d81d"),r("0481"),r("4069"),r("159b"),r("04b3")),l=r("fd85"),d=r("2f62"),h=r("ca00"),p={name:"Authorization",components:{ArrowDownIcon:u["c"]},data:function(){return{accountDetails:{},selectedRole:"",showValidText:!1,roleList:[],customRoleList:[],userName:"",treeCheckedKeys:[]}},computed:Object(s["a"])(Object(s["a"])({showEidt:function(){var t=this,e=[].concat(Object(i["a"])(this.roleList),Object(i["a"])(this.customRoleList)).filter((function(e){return e.roleId==t.selectedRole}));return e.length&&2==e.pop().isDefault}},Object(d["c"])(["roles"])),{},{treeData:function(){return this.filterMenu(this.roles)}}),mounted:function(){this.selectedRole=this.$route.query.roleId||"",this.userName=this.$route.query.userName||"",this.getRoleList(),this.changeRole()},methods:{getRoleList:function(){var t=this;return Object(c["a"])(Object(o["a"])().mark((function e(){var r,n;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["i"])();case 2:if(r=e.sent,0===r.code){e.next=5;break}return e.abrupt("return");case 5:n=r.data,n.length>0&&(t.roleList=n.filter((function(t){return 1==t.isDefault})),t.customRoleList=n.filter((function(t){return 2==t.isDefault})));case 7:case"end":return e.stop()}}),e)})))()},changeRole:function(){var t=this;return Object(c["a"])(Object(o["a"])().mark((function e(){var r;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.selectedRole){e.next=9;break}return e.next=3,Object(l["h"])({id:t.selectedRole});case 3:if(r=e.sent,0===r.code){e.next=6;break}return e.abrupt("return");case 6:if(r.data.menuIds&&0!==r.data.menuIds.length){e.next=8;break}return e.abrupt("return");case 8:t.treeCheckedKeys=Object(h["e"])(t.treeData,r.data.menuIds,"id").map((function(t){return t.flat(2)}))||[];case 9:case"end":return e.stop()}}),e)})))()},handleSave:function(){var t=this;return Object(c["a"])(Object(o["a"])().mark((function e(){var r;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.showValidText=!t.selectedRole,!t.showValidText){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Object(l["j"])({roleId:t.selectedRole,userName:t.userName});case 5:if(r=e.sent,0===r.code){e.next=8;break}return e.abrupt("return");case 8:t.$router.push({path:"/authority/index"});case 9:case"end":return e.stop()}}),e)})))()},deleteRole:function(t){var e=this;this.$WarningModal(this,this.$t("authorization.role.delete.warning"),"",this.$t("public.delete")).then(Object(c["a"])(Object(o["a"])().mark((function r(){var n;return Object(o["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(l["d"])({id:t});case 2:if(n=r.sent,0===n.code){r.next=5;break}return r.abrupt("return");case 5:e.getRoleList();case 6:case"end":return r.stop()}}),r)}))))},handleCancel:function(){this.$router.push({path:"/authority/index"})},addCustomRole:function(){this.$router.push({path:"/authority/customRole/index",query:{userName:this.userName}})},editAuthorization:function(){this.$router.push({path:"/authority/customRole/index",query:{roleId:this.selectedRole,userName:this.userName}})},filterMenu:function(t){var e=this,r=[];return t.forEach((function(t){1==t.visible&&(t.children&&(t.children=e.filterMenu(t.children)),r.push(t))})),r},back:function(){this.$router.push({path:"/authority/index"})}}},b=p,f=(r("ebd9"),r("2877")),m=Object(f["a"])(b,n,a,!1,null,"25adf6aa",null);e["default"]=m.exports},bb90:function(t,e,r){},ebd9:function(t,e,r){"use strict";r("bb90")},fd85:function(t,e,r){"use strict";r.d(e,"g",(function(){return a})),r.d(e,"a",(function(){return o})),r.d(e,"e",(function(){return c})),r.d(e,"c",(function(){return i})),r.d(e,"i",(function(){return s})),r.d(e,"j",(function(){return u})),r.d(e,"h",(function(){return l})),r.d(e,"b",(function(){return d})),r.d(e,"f",(function(){return h})),r.d(e,"d",(function(){return p}));var n=r("b775");function a(t){return Object(n["b"])({url:"/v1/platform/web/open/auth/list",method:"get",params:t})}function o(t){return Object(n["b"])({url:"/v1/platform/web/open/auth/add",method:"post",data:t})}function c(t){return Object(n["b"])({url:"/v1/platform/web/open/auth/remark",method:"post",data:t})}function i(t){return Object(n["b"])({url:"/v1/platform/web/open/auth/delete",method:"post",data:t})}function s(t){return Object(n["b"])({url:"/v1/platform/web/open/role/list",method:"get",params:t})}function u(t){return Object(n["b"])({url:"/v1/platform/web/open/role/user",method:"post",data:t})}function l(t){return Object(n["b"])({url:"/v1/platform/web/open/role",method:"get",params:t})}function d(t){return Object(n["b"])({url:"/v1/platform/web/open/role",method:"post",data:t})}function h(t){return Object(n["b"])({url:"/v1/platform/web/open/role/update",method:"post",data:t})}function p(t){return Object(n["b"])({url:"/v1/platform/web/open/role/delete",method:"post",data:t})}}}]);