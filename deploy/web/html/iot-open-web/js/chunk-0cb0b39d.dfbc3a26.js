(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0cb0b39d"],{"7aa3":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("section",{staticClass:"page-wrap no-padding",on:{click:function(e){t.showProductSearch=!1}}},[e("a-page-header",{attrs:{title:t.$t("firmware.OTA.title")}},[t.noData?t._e():[e("product-change",{attrs:{productId:t.defaultProductId},on:{dataChange:t.productChange,isData:t.isData}}),e("section",{staticClass:"content"},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:10}},[e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",[e("a-input",{attrs:{placeholder:t.$t("firmware.inputName"),allowClear:!0},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.queryList.apply(null,arguments)}},model:{value:t.queryParam.query.firmwareName,callback:function(e){t.$set(t.queryParam.query,"firmwareName",e)},expression:"queryParam.query.firmwareName"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",[e("a-input",{attrs:{placeholder:t.$t("firmware.inputKey"),allowClear:!0},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.queryList.apply(null,arguments)}},model:{value:t.queryParam.query.id,callback:function(e){t.$set(t.queryParam.query,"id",e)},expression:"queryParam.query.id"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",[e("a-select",{attrs:{placeholder:t.$t("firmware.type"),"default-value":"0",options:t.$DictList("firmware_type"),allowClear:!0},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.queryList.apply(null,arguments)}},model:{value:t.queryParam.query.firmwareType,callback:function(e){t.$set(t.queryParam.query,"firmwareType",e)},expression:"queryParam.query.firmwareType"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons"},[e("a-space",{attrs:{size:10}},[e("a-button",{attrs:{type:"primary"},on:{click:t.queryList}},[t._v(t._s(t.$t("public.query")))]),e("a-button",{staticClass:"regular-button",on:{click:t.reset}},[t._v(t._s(t.$t("public.reset")))])],1)],1)])],1)],1)],1),e("div",{staticClass:"table-operator"},[e("a-button",{staticClass:"grean-button",attrs:{type:"primary"},on:{click:function(e){return t.handleEdit({},"add")}}},[e("icon-font",{style:{fontSize:"18px"},attrs:{type:"icon-add"}}),t._v(" "+t._s(t.$t("firmware.new-built.OTA"))+" ")],1)],1),e("a-table",{attrs:{size:"small",rowKey:"id","data-source":t.dataSource,columns:t.columns,loading:t.loading,pagination:t.pagination},on:{change:t.onChangePagination},scopedSlots:t._u([{key:"serial",fn:function(a,i,r){return e("span",{},[t._v(" "+t._s(r+1)+" ")])}},{key:"firmwareName",fn:function(a,i){return e("span",{staticClass:"firmware-name",on:{click:function(e){return t.handleEdit(i,"check")}}},[t._v(" "+t._s(a)+" ")])}},{key:"status",fn:function(e){return[t._v(" "+t._s(t.$DictName("ota_release_status",e.status))+" ")]}},{key:"action",fn:function(a){return[e("section",{staticClass:"action-wrap"},[3==a.status?e("a-button",{attrs:{type:"link",size:"small"},on:{click:function(e){return t.stopRelease(a.id)}}},[t._v(" "+t._s(t.$t("public.stoped"))+" ")]):t._e(),3==a.status?e("a-divider",{attrs:{type:"vertical"}}):t._e(),e("a-button",{staticStyle:{width:"70px"},attrs:{type:"link",size:"small"},on:{click:function(e){return t.handleRelease(a)}}},[t._v(" "+t._s(t.$DictName("ota_release_button_status",a.status))+" ")]),e("a-divider",{attrs:{type:"vertical"}}),e("a-button",{attrs:{type:"link",size:"small"},on:{click:function(e){return t.handleRecord(a)}}},[t._v(" "+t._s(t.$t("public.record"))+" ")]),e("a-divider",{attrs:{type:"vertical"}}),e("a-button",{attrs:{type:"link",size:"small",disabled:1!==a.status},on:{click:function(e){return t.handleEdit(a,"edit")}}},[t._v(" "+t._s(t.$t("public.edit"))+" ")]),e("a-divider",{attrs:{type:"vertical"}}),e("a-button",{attrs:{type:"link",size:"small",disabled:1!==a.status},on:{click:function(e){return t.handleDelete(a.id)}}},[t._v(" "+t._s(t.$t("public.delete"))+" ")])],1)]}}],null,!1,889241006)})],1)],t.noData?[e("no-data",{attrs:{text:t.$t("firmware.OTA.noData.text"),buttonText:t.$t("firmware.OTA.noData.title"),path:"/product/product/createProduct/index"}})]:t._e(),e("release-ota",{attrs:{visible:t.releaseOTAVisible,data:t.releaseOTAData},on:{handleCancel:t.cancelRelease,handleOk:t.sumitRelease}}),e("edit-ota",{attrs:{moduleId:t.productDetails.moduleId,productKey:t.productDetails.productKey,productId:t.productDetails.id,visible:t.editOTAVisible,firmwareOtaData:t.otaData,type:t.OTAEditType},on:{handleOk:t.sumitEdit,handleCancel:t.cancelEdit}})],2)],1)},r=[],n=a("5530"),s=a("c7eb"),c=a("1da1"),u=(a("99af"),a("b0c0"),a("909e")),o=a("9c58"),l=a("8be3"),d=a("4966"),p=a("501e"),m={name:"Firmware",components:{ReleaseOta:u["default"],EditOta:o["default"],ProductChange:d["a"],NoData:p["a"]},data:function(){var t=this;return{pagination:{showSizeChanger:!0,current:1,pageSize:10,total:0,showTotal:function(e,a){return t.$t("public.pagination.total")+":".concat(e)+t.$t("public.pagination.current")+":".concat(a[0],"-").concat(a[1])}},queryParam:{page:1,limit:10,query:{}},columns:[{title:this.$t("firmware.sort"),scopedSlots:{customRender:"serial"}},{dataIndex:"firmwareName",title:this.$t("firmware.name"),scopedSlots:{customRender:"firmwareName"}},{dataIndex:"id",title:this.$t("firmware.key")},{dataIndex:"firmwareTypeName",title:this.$t("firmware.type")},{dataIndex:"version",title:this.$t("firmware.version")},{dataIndex:"upgradeModeName",title:this.$t("firmware.upgradeType")},{title:this.$t("firmware.status"),key:"status",align:"center",scopedSlots:{customRender:"status"}},{title:this.$t("public.action"),key:"action",align:"center",width:"360px",scopedSlots:{customRender:"action"}}],dataSource:[],loading:!1,releaseOTAVisible:!1,releaseOTAData:{},editOTAVisible:!1,otaData:{versionId:void 0},OTAEditType:"",productDetails:"",noData:!1,defaultProductId:""}},created:function(){this.defaultProductId=this.$route.params.productId,this.$route.meta.isBack||Object.assign(this.$data,this.$options.data.call(this))},beforeRouteEnter:function(t,e,a){t.meta.isBack="/product/firmwareOTA/record/index"===e.path||"/dashboard/index"===e.path,a()},activated:function(){this.$route.meta.isBack&&(this.$route.meta.isBack=!1,this.queryList())},methods:{productChange:function(t){this.productDetails=t,this.queryParam.page=1,this.queryList()},isData:function(t){this.noData=!t},onChangePagination:function(t){this.queryParam.page=t.current,this.queryParam.limit=t.pageSize,this.pagination.current=t.current,this.pagination.pageSize=t.pageSize,this.queryList()},reset:function(){this.queryParam={page:1,limit:10,query:{}},this.queryList()},queryList:function(){var t=this;this.queryParam.query.productId=this.productDetails.id,Object(l["e"])(this.queryParam).then((function(e){0===e.code&&(t.dataSource=e.data.list)}))},handleRelease:function(t){this.releaseOTAData=t,this.releaseOTAData.productName=this.productDetails.name,this.releaseOTAVisible=!0},cancelRelease:function(){this.releaseOTAVisible=!1},sumitRelease:function(){this.releaseOTAVisible=!1,this.queryList()},stopRelease:function(t){var e=this;return Object(c["a"])(Object(s["a"])().mark((function a(){return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.$WarningModal(e,e.$t("firmware.OTA.isStop.public")).then(Object(c["a"])(Object(s["a"])().mark((function a(){var i;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(l["m"])({id:t});case 2:if(i=a.sent,0===i.code){a.next=5;break}return a.abrupt("return");case 5:e.queryList();case 6:case"end":return a.stop()}}),a)}))));case 1:case"end":return a.stop()}}),a)})))()},handleRecord:function(t){var e=this;return Object(c["a"])(Object(s["a"])().mark((function a(){return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.$router.push({path:"/product/firmwareOTA/record/index",query:{id:t.id,productId:e.productDetails.id,productKey:e.productDetails.id}});case 1:case"end":return a.stop()}}),a)})))()},handleEdit:function(t,e){var a=this;return Object(c["a"])(Object(s["a"])().mark((function i(){return Object(s["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:"add"==e?a.otaData={versionId:void 0,specifiedAreaArr:[],specifiedVersionArr:[]}:(a.otaData=Object(n["a"])({isMust:2},t),t.specifiedArea&&(a.otaData.specifiedAreaArr=t.specifiedArea.split(",")||[]),t.specifiedVersion&&(a.otaData.specifiedVersionArr=t.specifiedVersion.split(",")||[])),a.otaData.productId=a.productDetails.id,a.otaData.productName=a.productDetails.name,a.OTAEditType=e,a.editOTAVisible=!0;case 5:case"end":return i.stop()}}),i)})))()},cancelEdit:function(){this.editOTAVisible=!1},sumitEdit:function(){var t=this;return Object(c["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.queryList(),t.editOTAVisible=!1;case 2:case"end":return e.stop()}}),e)})))()},handleDelete:function(t){var e=this;this.$WarningModal(this,this.$t("firmware.OTA.isDelete.ota")).then(Object(c["a"])(Object(s["a"])().mark((function a(){var i;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(l["b"])({id:t});case 2:if(i=a.sent,0===i.code){a.next=5;break}return a.abrupt("return");case 5:1==e.dataSource.length&&1!=e.queryParam.page&&(e.queryParam.page--,e.pagination.current--),e.queryList();case 7:case"end":return a.stop()}}),a)}))))}}},f=m,h=(a("d912"),a("2877")),y=Object(h["a"])(f,i,r,!1,null,"39539377",null);e["default"]=y.exports},cf58:function(t,e,a){},d912:function(t,e,a){"use strict";a("cf58")}}]);