(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-87185150"],{5404:function(t,e,i){},"79e2":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"flex y-axis-center x-space-between count-wrap"},[e("div",{staticClass:"flex y-axis-center count"},[e("div",[t._v(t._s(t.$t("setting.function.definition.title")))]),e("div",{staticClass:"num"},[t._v(t._s(t.regularData.length+t.$t("public.unit.pieces")))]),e("a-divider",{attrs:{type:"vertical"}}),e("div",[t._v(t._s(t.$t("setting.function.definition.custom.title")))]),e("div",{staticClass:"num"},[t._v(t._s(t.customizeData.length+t.$t("public.unit.pieces")))])],1),e("a-button",{attrs:{disabled:0==t.regularData.length&&0==t.customizeData.length},on:{click:t.handleExport}},[t._v(t._s(t.$t("setting.function.definition.export.btn")))])],1),e("section",{staticClass:"flex y-axis-center x-space-between card-header"},[e("span",{staticClass:"title"},[t._v(t._s(t.$t("setting.function.definition.title")))]),e("div",[2==t.status?e("a-button",{staticClass:"reset-btn",on:{click:t.resetRequiredFunc}},[t._v(t._s(t.$t("setting.function.definition.reset.required")))]):t._e(),2==t.status?e("a-button",{on:{click:t.addStandard}},[t._v(t._s(t.$t("setting.function.definition.addStandard")))]):t._e()],1)]),e("a-table",{attrs:{rowKey:"id",size:"small","data-source":t.regularData,columns:t.columns,loading:t.regularLoading,pagination:!1},scopedSlots:t._u([{key:"required",fn:function(e){return[t._v(" "+t._s(t.$DictName("yes_no",e))+" ")]}},{key:"action",fn:function(i){return[e("a-button",{attrs:{type:"link",size:"small"},on:{click:function(e){return t.editFunction(i)}}},[t._v(t._s(t.$t("public.edit")))]),1!=i.required?e("a-divider",{attrs:{type:"vertical"}}):t._e(),1!=i.required?e("a-button",{attrs:{type:"link",size:"small"},on:{click:function(e){return t.handleDelete(i,0)}}},[t._v(t._s(t.$t("public.delete")))]):t._e()]}}])}),e("section",{staticClass:"flex y-axis-center x-space-between card-header"},[e("span",{staticClass:"title"},[t._v(t._s(t.$t("setting.function.definition.custom.title")))]),2==t.status?e("a-button",{on:{click:t.addCustom}},[t._v(t._s(t.$t("setting.function.definition.addCustom")))]):t._e()],1),e("a-table",{attrs:{rowKey:"id",size:"small","data-source":t.customizeData,columns:t.columns,loading:t.customLoading,pagination:!1},scopedSlots:t._u([{key:"required",fn:function(e){return[t._v(" "+t._s(t.$DictName("yes_no",e))+" ")]}},2==t.status?{key:"action",fn:function(i){return[e("a-button",{attrs:{type:"link",size:"small"},on:{click:function(e){return t.editFunction(i)}}},[t._v(t._s(t.$t("public.edit")))]),1!=i.required?e("a-divider",{attrs:{type:"vertical"}}):t._e(),1!=i.required?e("a-button",{attrs:{type:"link",size:"small"},on:{click:function(e){return t.handleDelete(i,1)}}},[t._v(t._s(t.$t("public.delete")))]):t._e()]}}:null],null,!0)}),e("add-standard-function",{attrs:{productId:t.productId,baseProductId:t.baseProductId,list:t.addStandardFunction,visible:t.standardModalVisible},on:{confirmEdit:t.confirmStandardAdd,cancelEdit:t.cancelStandardAdd}}),e("edit-function",{attrs:{productId:t.productId,data:t.editFunctionData,visible:t.customModalVisible},on:{confirmEdit:t.confirmEdit,cancelEdit:t.cancelEdit}})],1)},a=[],s=i("2909"),c=i("5530"),d=i("c7eb"),o=i("1da1"),u=(i("a9e3"),i("b0c0"),i("d81d"),i("b64b"),i("4de4"),i("d3b7"),i("159b"),i("a15b"),i("7db0"),i("a434"),i("69e6")),r=i("4270"),l=i("c4c8"),f=i("ca00"),p={name:"FunctionDefinition",props:{status:{type:Number,default:0},productId:{type:String,default:""},baseProductId:{type:String,default:""},activeTab:{type:Number,default:0},details:{type:Object,default:{}}},components:{EditFunction:u["default"],AddStandardFunction:r["default"]},data:function(){return{columns:[{dataIndex:"dpid",title:this.$t("setting.function.definition.columns.dpid"),width:"60px"},{dataIndex:"name",title:this.$t("setting.function.definition.columns.name"),width:"80px"},{dataIndex:"required",title:this.$t("setting.function.definition.columns.required"),scopedSlots:{customRender:"required"},width:"50px"},{dataIndex:"identifier",title:this.$t("setting.function.definition.columns.identifier")},{dataIndex:"rwFlagDesc",title:this.$t("setting.function.definition.columns.rwFlagDesc"),width:"130px"},{dataIndex:"dataTypeDesc",title:this.$t("setting.function.definition.columns.dataTypeDesc")},{dataIndex:"dataSpecsDesc",title:this.$t("setting.function.definition.columns.dataSpecsDesc"),width:"30%"},{dataIndex:"defaultValText",title:this.$t("setting.function.definition.columns.defaultVal"),width:"60px"}],regularData:[],customizeData:[],regularLoading:!1,customLoading:!1,customModalVisible:!1,editFunctionData:{},standardModalVisible:!1,addStandardFunction:[]}},mounted:function(){this.actionShow(this.status)},watch:{status:function(t){this.actionShow(t)},productId:function(t){t&&(this.getFuncList(0),this.getFuncList(1))},activeTab:function(t){0===t&&(this.getFuncList(0),this.getFuncList(1))}},methods:{handleExport:function(){this.$DownloadTemplate(this,{url:"/v1/platform/web/open/product/thingModels/export",productId:this.productId},this.details.name+this.$t("setting.thingModels")+".xlsx","get")},getFuncList:function(t){var e=this;return Object(o["a"])(Object(d["a"])().mark((function i(){var n,a,s;return Object(d["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,Object(l["t"])({productId:e.productId,custom:t});case 2:if(n=i.sent,0===n.code){i.next=5;break}return i.abrupt("return");case 5:1==t?e.customizeData=e.dealList((null===(a=n.data)||void 0===a?void 0:a.list)||[]):e.regularData=e.dealList((null===(s=n.data)||void 0===s?void 0:s.list)||[]);case 6:case"end":return i.stop()}}),i)})))()},dealList:function(t){return t.map((function(t){if("ENUM"==t.dataType&&!Object(f["h"])(t.defaultVal)){var e,i=JSON.parse(t.dataSpecsList),n=(null===(e=i.filter((function(e){return e.value==t.defaultVal})))||void 0===e||null===(e=e.pop())||void 0===e?void 0:e.name)||"";return Object(c["a"])(Object(c["a"])({},t),{},{defaultValText:n})}return Object(c["a"])(Object(c["a"])({},t),{},{defaultValText:t.defaultVal})}))},addCustom:function(){this.customModalVisible=!0,this.editFunctionData={custom:1}},editFunction:function(t){t.notAllowEdit?this.$InfoModal(this,this.$t("setting.function.definition.notAllowEdit"),this.$t("public.prompt")):(this.editFunctionData=Object(c["a"])({},t),this.customModalVisible=!0)},confirmEdit:function(t){this.getFuncList(t),this.customModalVisible=!1},cancelEdit:function(){this.customModalVisible=!1},addStandard:function(){this.addStandardFunction=Object(s["a"])(this.regularData),this.standardModalVisible=!0},confirmStandardAdd:function(){this.getFuncList(0),this.standardModalVisible=!1},cancelStandardAdd:function(){this.standardModalVisible=!1},handleDelete:function(t,e){var i=this;this.$createElement;this.$WarningModal(this,this.$t("setting.function.definition.isDelete.function")).then(Object(o["a"])(Object(d["a"])().mark((function n(){var a,s,c,u,r,f;return Object(d["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(l["h"])({id:t.id,funcType:t.funcType,productId:i.productId});case 2:if(a=n.sent,0===a.code){n.next=5;break}return n.abrupt("return");case 5:a.data.showDeleteMsg?(s=[],c=a.data.voice,u=i.$DictList("oem_app_voice"),Object.keys(c).forEach((function(t){var e;c[t]&&s.push(null===(e=u.filter((function(e){return e.value==t})))||void 0===e||null===(e=e.pop())||void 0===e?void 0:e.label)})),r=i.$t("setting.function.definition.notAllowEdit"),f=i.$t("setting.function.definition.platform.relation",{platform:s.join("„ÄÅ")}),i.$ConfirmCustomModal(i,(function(t){return t("div",{style:"text-align:center;"},[r,t("br"),f])}),i.$t("public.prompt"),i.$t("setting.function.definition.tovoice.edit"),i.$t("public.close.text")).then(Object(o["a"])(Object(d["a"])().mark((function t(){return Object(d["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:i.$emit("changeTab",4);case 1:case"end":return t.stop()}}),t)}))),(function(){}))):(i.$message.info(i.$t("public.delete_success")),i.getFuncList(e));case 6:case"end":return n.stop()}}),n)}))))},actionShow:function(t){var e=this.columns.find((function(t){return"action"===t.key}));2!=t||e||this.columns.push({title:this.$t("public.action"),key:"action",align:"left",width:"130px",scopedSlots:{customRender:"action"}}),1==t&&e&&this.columns.splice(-1,1)},resetRequiredFunc:function(){var t=this;this.$ConfirmModal(this,this.$t("setting.function.definition.reset.confirm.msg"),this.$t("setting.function.definition.reset.confirm.title")).then(Object(o["a"])(Object(d["a"])().mark((function e(){var i;return Object(d["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["L"])({productId:t.productId});case 2:if(i=e.sent,0===i.code){e.next=5;break}return e.abrupt("return");case 5:t.$message.info(t.$t("public.action.succeed")),t.getFuncList(0);case 7:case"end":return e.stop()}}),e)}))))}}},h=p,b=(i("928d"),i("2877")),m=Object(b["a"])(h,n,a,!1,null,"70b5482e",null);e["default"]=m.exports},"928d":function(t,e,i){"use strict";i("5404")}}]);